/*! todoapp - v1.0.0 - 2017-07-19 */
liteJS.ready(function(){liteJS.app("myApp").run(["router","config","ajax"],function(t,e){e.templateFunc=function(t,e){return templates[t](e)},e.defaultLayout="site-layout",t.registerRoutes({"/":{component:"indexComponent",config:{login:!1}},"/todo-list":{component:"todoListComponent",config:{login:!1}}}),t.beforeRouteChange(function(t){t.done()}),t.afterRouteChange(function(t){})}),"serviceWorker"in navigator&&navigator.serviceWorker.register("./todo-app-sw.js").then(function(){console.log("Service Worker Registered")})}),liteJS.component("headerComponent",[],function(){this.init=function(){this.render("headerTemplate")}}),liteJS.component("indexComponent",["todoService"],function(t){this.init=function(){var e=t.getAll();this.render("indexTemplate",{title:"hello Vijay",totalTodoList:e.length})}}),liteJS.component("sidebarComponent",[],function(){this.init=function(){this.render("sidebarTemplate"),$(".button-collapse").sideNav({menuWidth:300,edge:"left",closeOnClick:!0,draggable:!0,onOpen:function(t){},onClose:function(t){}})}}),liteJS.component("editTodoComponent",["query","loggerService"],function(t,e){function o(){$(n.element).find(".edit-todo").modal("close"),n.remove()}var n=this;this.events={"click .save":function(t){var e=$(n.element).find("form").get(0);e.title.value?(n.data.title=e.title.value,n.data.description=e.description.value,n.notifyParent("on:save-todo",n.data),o()):$(e.title).siblings(".error").addClass("show")},"click .cancel":o},this.init=function(t){n.data=t,this.render("editTodoTemplate",t),$(this.element).find(".edit-todo").modal("open"),e.on("log:msg",function(t){alert(t)},this.key)},this.destroy=function(){e.off("log:msg",this.key)}}),liteJS.component("todoComponent",["q"],function(t){var e=this;this.events={"click .edit":function(o){o.preventDefault(),t.when(e.notifyParentExP).params(["on:edit-todo",e.data]).success(function(t){e.reRender(t)})},"click .delete":function(t){t.preventDefault(),e.notifyParent("on:remove-todo",e.data)},"click input[type=checkbox]":function(t){$(e.element).toggleClass("done"),e.data.done=!e.data.done,e.notifyParent("on:save-todo",e.data)}},this.init=function(t){e.data=t,this.render("todoTemplate",t)}}),liteJS.component("todoListComponent",["ajax","query","todoService"],function(t,e,o){function n(t){setTimeout(function(){if(t&&t.length){i.innerHTML="";for(var o=0;o<t.length;o++){var n=e.new("tr");r.createAddChild("todoComponent",t[o],n,i),t[o].done&&(n.className="done")}}else i.innerHTML="<span>There are no task to show!</span>"},0)}var i,d,a,r=this;this.events={"click .add-todo":function(){r.createAddChild("editTodoComponent",{},e.new("div"),d)}},this.init=function(){this.render("todoListTemplate"),i=e(this.element).find(".todo-list").get(0),d=e(r.element).find("#edit-todo").get(0),n(o.getAll()),this.on("on:edit-todo",function(t){a=t.deferred,r.createAddChild("editTodoComponent",t.data,e.new("div"),d)},this.key),this.on("on:save-todo",function(t){t.data.id?(a&&(a.resolve(t.data),a=null),o.updateTodo(t.data)):(o.addTodo(t.data),n(o.getAll()))},this.key),this.on("on:remove-todo",function(t){o.removeTodo(t.data),n(o.getAll())},this.key)}}),liteJS.service("loggerService",[],function(){this.log=function(){this.trigger("log:msg",msg)}}),liteJS.service("todoService",[],function(){function t(){return JSON.parse(localStorage.getItem("todo-list"))}this.export={getAll:t,addTodo:function(e){var o=t();return o?e.id=o.length+1:(o=[],e.id=1),o.push(e),localStorage.setItem("todo-list",JSON.stringify(o)),e},removeTodo:function(e){for(var o=t(),n=0;n<o.length;n++)if(o[n].id==e.id){o.splice(n,1);break}localStorage.setItem("todo-list",JSON.stringify(o))},updateTodo:function(e){for(var o=t(),n=0;n<o.length;n++)if(o[n].id==e.id){o[n].title=e.title,o[n].description=e.description,o[n].done=e.done;break}localStorage.setItem("todo-list",JSON.stringify(o))}}});